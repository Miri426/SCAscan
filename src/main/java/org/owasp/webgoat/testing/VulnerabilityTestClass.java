package org.owasp.webgoat.testing;

import org.apache.log4j.Logger;
import org.apache.struts2.StrutsConstants;
import org.springframework.core.SpringVersion;
import org.apache.commons.collections.Transformer;
import org.apache.commons.collections.functors.ChainedTransformer;
import org.apache.commons.collections.functors.ConstantTransformer;
import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.TransformedMap;

/**
 * This class exists purely to import and use vulnerable dependencies
 * so that OWASP Dependency Check will scan them.
 */
public class VulnerabilityTestClass {
    
    private static final Logger logger = Logger.getLogger(VulnerabilityTestClass.class);
    
    public void testMethod() {
        // Use Log4j 1.2.17
        logger.info("Testing vulnerable Log4j version: " + Logger.class.getPackage().getImplementationVersion());
        
        // Use Struts 2
        String strutsVersion = StrutsConstants.STRUTS_VERSION;
        logger.info("Using Struts version: " + strutsVersion);
        
        // Use Spring Framework
        String springVersion = SpringVersion.getVersion();
        logger.info("Using Spring version: " + springVersion);
        
        // Use Commons Collections (in a non-malicious way)
        Transformer[] transformers = new Transformer[] {
            new ConstantTransformer(1)
        };
        Transformer transformerChain = new ChainedTransformer(transformers);
        logger.info("Using Commons Collections transformer: " + transformerChain.getClass().getName());
    }
}